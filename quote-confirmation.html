<!DOCTYPE html>
<html lang="en">
<head>
    <title>Booking Confirmation | Webwing Agency</title>

    <link rel="preload" href="css/global.css" as="style" />

    <link rel="stylesheet" href="css/global.css">
 
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
 
   <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.7/gsap.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/@barba/core"></script>
   <script src="https://unpkg.com/@barba/head/dist/barba-head.umd.js"></script>
   <link rel="icon" href="assets/icons/favicon.svg" type="image/png" />

   <script src="js/components/cta.js"></script>
   <script src="js/components/nav.js"></script>
   <script src="js/components/footer.js"></script>
 
   <style>
    body {
        height: 100vh;
        width: 100vw;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        gap: 15px;
    }
    </style>

</head>

<body>


<header>
    <nav id="standard-nav"></nav>
</header>

    <i class="fa-solid fa-check fa-2xl" style="color: #0ed100; font-size: 7rem; line-height: 8rem;"></i>
    <h1>Your Meeting is booked</h1>

    <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
    <script>
      emailjs.init("72yexfrXpqwZWs_yj");
    
      window.addEventListener("DOMContentLoaded", async () => {
        // parse all quote fields from the URL:
        const qs = new URLSearchParams(window.location.search);
        const payload = {
          // â€œto_nameâ€ in the template â† qs.get("requesterName")
          to_name:      qs.get("requesterName")   || "(no name provided)",

           // **NEW**: Matches {{to_email}} (the recipient address)
           to_email:     qs.get("requesterEmail")  || "(no email provided)",

          // â€œproject_typeâ€ in the template â† qs.get("projectType")
          project_type: qs.get("projectType")     || "(unspecified)",

          // â€œpagesâ€ in the template â† qs.get("pages")
          pages:        qs.get("pages")           || "0",

          // â€œtimelineâ€ in the template â† qs.get("timelineWeeks")  + " weeks"
          // (you can append â€œ weeksâ€ or leave it numeric per your design)
          timeline:     (qs.get("timelineWeeks")
                        ? qs.get("timelineWeeks") + " weeks"
                        : "(no timeline)"),

          // â€œestimateâ€ in the template â† qs.get("estimatedPrice")
          estimate:     qs.get("estimatedPrice")  || "(no estimate)",

          // If your template also uses a â€œreply_toâ€ or you want to CC/BCC, you could add:
          // reply_to:    qs.get("requesterEmail")   || "",
          // but only if your template has {{reply_to}} somewhere.
          };

      console.log("[DEBUG] Mapped payload:", payload);

      // (3) If you require a real email address for â€œreply_toâ€ or similar, check itâ€”
      //     otherwise, you can send even without it if your template doesnâ€™t need it.
      //     In your template snippet, I donâ€™t see a {{reply_to}} or {{from_email}} variable,
      //     so we donâ€™t strictly need requesterEmail unless you plan to add it somewhere.

      // If your template does require an actual â€œfromâ€ or â€œreply_toâ€ parameter, add:
      //   if (!qs.get("requesterEmail")) { â€¦redirect/alertâ€¦ }

      try {
      console.log("ğŸ”„ Sending email with payload:", payload);
        const result = await emailjs.send(
          "service_xyivz2l",          // â† your exact Service ID
          "template_lt94358",         // â† your exact Template ID
          payload
        );
        console.log("âœ… EmailJS success:", result);
        alert("âœ… Quote email has been sent. Check your inbox.");
        } catch (err) {
        console.error("âŒ EmailJS error:", err);
        if (err.status) {
          console.error("HTTP status:", err.status);
          console.error("HTTP response text:", err.text);
        }
        alert("âŒ Failed to send email. See console for details.");
        }
        });
    </script>
    
</body>
</html>